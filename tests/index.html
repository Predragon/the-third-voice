<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>The Third Voice</title>
  <style>
    /* your full CSS remains unchanged — it's already great */
    /* For brevity, I'm skipping the style block since you already pasted it — keep it exactly as is */
  </style>
</head>
<body>
  <div class="container">
    <h1>The Third Voice</h1>
    <div class="app">
      <textarea id="messageInput" placeholder="Paste or type your message here..." aria-label="Enter your message to rewrite"></textarea>
      <div class="tone-selector">
        <button class="tone-btn active" data-tone="Kind">Kind</button>
        <button class="tone-btn" data-tone="Direct">Direct</button>
        <button class="tone-btn" data-tone="Honest">Honest</button>
        <button class="tone-btn" data-tone="Empathetic">Empathetic</button>
      </div>
      <button class="rewrite-btn" id="rewriteBtn">Rewrite It</button>
      <div class="error-message" id="errorMessage"></div>
      <div class="result" id="result" style="display: none;">
        <h3>Rewritten Message</h3>
        <div class="rewritten-text" id="rewrittenMessage"></div>
        <button class="copy-btn" onclick="copyRewrittenMessage()">Copy Message</button>
      </div>
    </div>

    <div class="section">
      <h2>Privacy Notice</h2>
      <p>Messages are processed using an AI model. Nothing is stored or saved.</p>
    </div>

    <div class="section">
      <h2>About The Third Voice</h2>
      <p>Created by Predrag Mirkovic in immigration detention using only a phone, The Third Voice is an emotionally intelligent AI assistant designed to help people rewrite emotionally charged messages with clarity and kindness.</p>
    </div>

    <footer>
      <p>Contact: <a href="mailto:hello@thethirdvoice.ai">hello@thethirdvoice.ai</a></p>
      <p>Website: <a href="https://www.thethirdvoice.ai" target="_blank">www.thethirdvoice.ai</a></p>
      <p>#TheThirdVoice</p>
    </footer>
  </div>

  <script>
    const messageInput = document.getElementById("messageInput");
    const rewriteBtn = document.getElementById("rewriteBtn");
    const rewrittenMessage = document.getElementById("rewrittenMessage");
    const resultDiv = document.getElementById("result");
    const errorMessage = document.getElementById("errorMessage");
    const toneButtons = document.querySelectorAll(".tone-btn");

    let selectedTone = "Kind";

    toneButtons.forEach((button) => {
      button.addEventListener("click", () => {
        toneButtons.forEach((btn) => btn.classList.remove("active"));
        button.classList.add("active");
        selectedTone = button.dataset.tone;
      });
    });

    rewriteBtn.addEventListener("click", async () => {
      const message = messageInput.value.trim();
      if (!message) return showError("Please enter a message");

      rewriteBtn.disabled = true;
      rewriteBtn.textContent = "Rewriting...";

      try {
        const response = await fetch("/api/rewrite", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message, tone: selectedTone }),
        });

        if (!response.ok) throw new Error("API call failed");

        const data = await response.json();
        rewrittenMessage.textContent = data.rewritten || "No response from model";
        resultDiv.style.display = "block";
      } catch (err) {
        showError("Error: " + err.message);
      } finally {
        rewriteBtn.disabled = false;
        rewriteBtn.textContent = "Rewrite It";
      }
    });

    function showError(message) {
      errorMessage.textContent = message;
      errorMessage.style.display = "block";
      setTimeout(() => {
        errorMessage.style.display = "none";
      }, 4000);
    }

    function copyRewrittenMessage() {
      const text = rewrittenMessage.textContent;
      navigator.clipboard.writeText(text);
    }
  </script>
</body>
</html>
